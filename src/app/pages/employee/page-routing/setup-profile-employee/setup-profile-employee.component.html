<!-- <app-employee-management></app-employee-management> -->

<form nz-form nzGutter="16" class="w-full" nzLayout="vertical" [formGroup]="form" (ngSubmit)="showDataEmployee()" style="background-color: #f3f3f3;">

    <div class="mx-4">
        <span class="label_setup">Thiết lập hồ sơ nhân sự</span>
    <div style="background-color: #fff; border-radius: 5px;">

        <!--css không figma-->
        <div class=" form-container p-4 pb-0">

            
            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.employeeName' | translate}}
                        <!-- {{form.get('name')?.errors | json}} -->
                    </label>
                    <input class="input-form" (input)="validateText('name',$event)"  placeholder="Nguyễn văn A"  formControlName="name" type="text" >
                    <div class="error-container">
                        <div *ngIf="form.get('name')?.invalid && form.get('name')?.dirty || form.get('name')?.touched">
                            <span class="validate_input" *ngIf="form.get('name')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            <span class="instruct" *ngIf="form.get('name')?.errors?.['pattern']">{{'required.text_pattern' | translate}}</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.yearOfBirth' | translate}}</label>
                    <input class="input-form" placeholder="2000" (input)="validateYearOfBirth('yearOfBirth',$event)" formControlName="yearOfBirth" maxlength="4" type="text">
                    <div class="error-container">
                        <div *ngIf="form.get('yearOfBirth')?.invalid && (form.get('yearOfBirth')?.dirty) || form.get('yearOfBirth' | translate)?.touched">
                            <span class="validate_input" *ngIf="form.get('yearOfBirth')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            <span class="instruct" *ngIf="form.get('yearOfBirth')?.errors?.['min'] && !form.get('yearOfBirth')?.errors?.['pattern']">{{ ('required.minYearEmployee' | translate) + minYear }}</span>
                            <span class="instruct" *ngIf="form.get('yearOfBirth')?.errors?.['max'] && !form.get('yearOfBirth')?.errors?.['pattern']">{{ ('required.maxYearEmployee' | translate)+maxYear }}</span>
                            <span class="instruct" *ngIf="form.get('yearOfBirth')?.errors?.['pattern']" >{{'required.number_pattern' | translate}}</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.gender' | translate}}</label>
                    <nz-select nzPlaceHolder="Nam" formControlName="gender" class="nzSelect">
                        <nz-option *ngFor="let gender of listGender" [nzValue]="gender.id" [nzLabel]="gender.value"></nz-option>
                    </nz-select>
                    <div class="error-container">
                        <div *ngIf="form.get('gender')?.invalid && (form.get('gender')?.dirty) || form.get('gender')?.touched">
                            <span class="validate_input" *ngIf="form.get('gender')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.identifier' | translate}}</label>
                    <input class="input-form" (input)="validateNumber('identifier', $event)" placeholder="002096278955" formControlName="identifierId" type="text" maxlength="12">
                    <div class="error-container">
                        <div class="error-container"> 
                            <div *ngIf="form.get('identifierId')?.invalid && (form.get('identifierId')?.dirty) || form.get('identifierId')?.touched">
                            <span class="validate_input" *ngIf="form.get('identifierId')?.errors?.['required']">{{'required.cannotBlank'  | translate}}</span>
                            <span class="instruct" *ngIf="form.get('identifierId')?.errors?.['pattern']">{{'required.identifier_pattern'  | translate}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.phoneNumber' | translate}}</label>
                    <input class="input-form" placeholder="0379458632" (input)="validateNumber('phoneNumber',$event)" [maxlength]="maxLengthMap['phoneNumber'] || 10" 
                    formControlName="phoneNumber" type="text">
                    <div class="error-container">
                        <div *ngIf="form.get('phoneNumber')?.invalid && (form.get('phoneNumber')?.dirty) || form.get('phoneNumber')?.touched">
                            <span class="validate_input" *ngIf="form.get('phoneNumber')?.errors?.['required']">{{'required.cannotBlank'  | translate}}</span>
                            <span class="instruct" *ngIf="form.get('phoneNumber')?.errors?.['pattern']">{{'required.phone_pattern'  | translate}}</span>
                            <span class="instruct" *ngIf="form.get('phoneNumber')?.errors?.['invalidLength']">{{'required.phone_pattern'  | translate}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.zalo' | translate}}</label>
                    <input class="input-form" (blur)="onBlur('zalo')" placeholder="Nguyễn văn A" formControlName="zalo" type="text">
                    <div class="error-container">
                        <div *ngIf="form.get('zalo')?.invalid && (form.get('zalo')?.dirty) || form.get('zalo')?.touched">
                            <span class="validate_input" *ngIf="form.get('zalo')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            <!-- <span class="instruct" *ngIf="form.get('zalo')?.errors?.['pattern']">{{'pattern.zalo' | translate}}</span> -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.email' | translate}}</label>
                    <input class="input-form" placeholder="@gmail.com" formControlName="email" type="text">
                    <div class="error-container">
                        <div *ngIf="form.get('email')?.invalid && (form.get('email')?.dirty) || form.get('email')?.touched">
                        <span class="validate_input" *ngIf="form.get('email')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                        <span class="instruct" *ngIf="form.get('email')?.errors?.['email']">{{'required.email_pattern' | translate}}</span>
                    </div>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.ethnicGroup' | translate}}</label>
                    <input class="input-form" (input)="validateText('ethnicGroup',$event)" (blur)="onBlur('ethnicGroup')" formControlName="ethnicGroup" placeholder="Nhập" />
                        <div class="error-container">
                            <div *ngIf="form.get('ethnicGroup')?.invalid && (form.get('ethnicGroup')?.dirty) || form.get('ethnicGroup')?.touched">
                                <span class="validate_input" *ngIf="form.get('ethnicGroup')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                <span class="instruct" *ngIf="form.get('ethnicGroup')?.errors?.['pattern']">{{'required.text_pattern' | translate}}</span>

                            </div>
                        </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <label class="label-form" for="" >{{'employee.religion' | translate}}<span style="font-weight: 400; line-height: 14.06px; color: gray; font-style: italic; font-size: 12px">{{'employee.ifHave'| translate}}</span></label>
                    <input class="input-form" (input)="validateText('religion',$event)"  formControlName="religion" placeholder="Nhập" />
                    <div class="error-container">
                        <div *ngIf="form.get('religion')?.invalid && (form.get('religion')?.dirty) || form.get('religion')?.touched">
                            <!-- <span class="validate_input" *ngIf="form.get('religion')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span> -->
                            <span class="instruct" *ngIf="form.get('religion')?.errors?.['pattern']">{{'required.text_pattern' | translate}}</span>
                        </div>
                    </div>
                </div>

            </div>
            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.professionalLevel' | translate}}</label>
                    <input class="input-form" formControlName="professionalLevel" placeholder="Nhập" />
                        <div class="error-container">
                            <div *ngIf="form.get('professionalLevel')?.invalid && (form.get('professionalLevel')?.dirty) || form.get('professionalLevel')?.touched">
                                <span class="validate_input" *ngIf="form.get('professionalLevel')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                
                            </div>
                        </div>
                </div>

            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.maritalStatus' | translate}}</label>
                    <nz-select nzPlaceHolder="Chưa kết hôn" formControlName="maritalStatus" class="nzSelect">
                        <nz-option *ngFor="let marialStatus of listMarialStatus" [nzValue]="marialStatus.id" [nzLabel]="marialStatus.value"></nz-option>
                    </nz-select>
                    <div class="error-container">
                        <div *ngIf=" form.get('maritalStatus')?.invalid && (form.get('maritalStatus')?.dirty) ||form.get('maritalStatus')?.touched">
                        <span class="validate_input" *ngIf="form.get('maritalStatus')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                    </div>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.contactPerson' | translate}}</label>
                    <input class="input-form" (input)="validateText('contactPerson',$event)" (blur)="onBlur('contactPerson')"  formControlName="contactPerson" placeholder="Nhập" />
                        <div class="error-container">
                            <div *ngIf="form.get('contactPerson')?.invalid && (form.get('contactPerson')?.dirty) || form.get('contactPerson')?.touched">
                                <span class="validate_input" *ngIf="form.get('contactPerson')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                <span class="instruct" *ngIf="form.get('contactPerson')?.errors?.['pattern']">{{'required.text_pattern'  | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.contactPersonPhone' | translate}}</label>
                    <input class="input-form" formControlName="contactPersonPhone" (input)="validateNumber('contactPersonPhone',$event)" placeholder="Nhập" [maxlength]="maxLengthMap['contactPersonPhone'] || 10" />
                        <div class="error-container">
                            <div class="error-container">
                                <div *ngIf="form.get('contactPersonPhone')?.invalid && form.get('contactPersonPhone')?.dirty || form.get('contactPersonPhone')?.touched">
                                    <span class="validate_input" *ngIf="form.get('contactPersonPhone')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                    <span class="instruct" *ngIf="form.get('contactPersonPhone')?.errors?.['pattern']">{{'required.phone_pattern'  | translate}}</span>
                                    <span class="instruct" *ngIf="form.get('contactPersonPhone')?.errors?.['invalidLength']">{{'required.phone_pattern'  | translate}}</span>
                                </div>
                            </div>
                        </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.staffRelation' | translate}}</label>
                    <input class="input-form" (input)="validateText('staffRelation',$event)"  (blur)="onBlur('staffRelation')"  formControlName="staffRelation" placeholder="Nhập" />
                        <div class="error-container">
                            <div *ngIf="form.get('staffRelation')?.invalid && (form.get('staffRelation')?.dirty) || form.get('staffRelation')?.touched">
                                <span class="validate_input" *ngIf="form.get('staffRelation')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                <span class="instruct" *ngIf="form.get('staffRelation')?.errors?.['pattern']">{{'required.text_pattern' | translate}}</span>

                            </div>
                        </div>
                </div>
            </div>

        </div>
        
        <div class="px-4 form-container" nz-row>
           
            <div class="mx-2 adrress-input" >
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.permanentAddress' | translate}}</label>
                    <input class="input-form" formControlName="permanentAddress" placeholder="Nhập" />
                        <div class="error-container">
                            <div *ngIf="form.get('permanentAddress')?.invalid && (form.get('permanentAddress')?.dirty) || form.get('permanentAddress')?.touched">
                                <span class="validate_input" *ngIf="form.get('permanentAddress')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div class="mx-2 adrress-input" >
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.temporaryAddress' | translate}}</label>
                    <input class="input-form" formControlName="temporaryAddress" placeholder="Nhập" />
                        <div class="error-container">
                            <div *ngIf="form.get('temporaryAddress')?.invalid && (form.get('temporaryAddress')?.dirty) || form.get('temporaryAddress')?.touched">
                                <span class="validate_input" *ngIf="form.get('temporaryAddress')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

        </div>

        <div style="border-bottom: 1px solid #dddddd;margin-left: 30px; margin-bottom: 18px; margin-top: 18px; margin-right: 20px"></div>


        <div class="mx-4 form-container ">
            <div class="mx-2 date-choose ">
                <label class="label-form label_form">{{'employee.workingStatus' | translate}}</label>
                <div nz-row nzSpan="5" style="border: 1px solid #d9d9d9; border-radius: 5px ;padding: 5px">
                    <div nz-col nzSpan="6">
                        <div class="form-control">
                            <div>
                                <nz-radio-group formControlName="contractType">
                                    <label nz-radio nzValue="1" style="margin-bottom: 30px !important;">Chính thức</label>
                                    <br>
                                    <label nz-radio nzValue="2" style="margin-top: 32px !important;">Thử việc</label>
                                </nz-radio-group>
                            </div>
                        </div>
                    </div>
                    <div nz-col nzSpan="18" >
                        <div nz-row style="width: calc(100% - 8px);" [class.disabled-input]="contract_type == 2">
                            <div class="form-control">
                                <label class="label-form "><span class="required-star" style="width: 100%; ">*</span>{{'employee.fromDate' | translate}}</label>
                                <div class="w-full">
                                    <nz-date-picker nzFormat="dd/MM/yyyy" style="width: calc(100% + 8px)"
                                        (ngModelChange)="onDateChange('fromDateOfOffical',$event)" class="w-full" formControlName="fromDateOfOffical"
                                        nzPlaceHolder="Chọn ngày"></nz-date-picker>
                                        <div class="error-container">
                                            <div *ngIf="(form.get('fromDateOfOffical')?.invalid && (form.get('fromDateOfOffical')?.dirty ||form.get('fromDateOfOffical')?.touched)) && contract_type == 1">
                                                <span class="validate_input" *ngIf="form.get('fromDateOfOffical')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </div>

                        <div nz-row style="width: calc(100% + 8px);" >
                            <div style="width: calc(50% - 8px);" [class.disabled-input]="contract_type == 1">
                                <div class="form-control">
                                    <label class="label-form"><span class="required-star" style="width: 100%; ">*</span>{{'employee.fromDate' | translate}}</label>
                                    <div class="w-full">
                                        <nz-date-picker class="w-full" style="width: calc(100% + 8px)"
                                            nzFormat="dd/MM/yyyy" (ngModelChange)="onDateChange('fromDateProbation',$event)" [nzDisabledDate]="disableAfterDate('toDate')"
                                            formControlName="fromDateProbation" nzPlaceHolder="Chọn ngày"></nz-date-picker>
                                        <div class="error-container">
                                            <div *ngIf="(form.get('fromDateProbation')?.invalid && (form.get('fromDateProbation')?.dirty ||form.get('fromDateProbation')?.touched)) && contract_type == 2">
                                                <span class="validate_input"  *ngIf="form.get('fromDateProbation')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div style="width: calc(50% - 8px);" [class.disabled-input]="contract_type == 1">
                                <div class="form-control">
                                    <label class="label-form"><span class="required-star" style="width: 100%; ">*</span>{{'employee.toDate' | translate}}</label>
                                    <div class="w-full">
                                        <nz-date-picker class="w-full" [nzDisabledDate]="disableBeforeDate('fromDateProbation')" [disabled]="!form.get('fromDate')?.value"
                                            nzFormat="dd/MM/yyyy" (ngModelChange)="onDateChange('fromDate',$event)" style="width: calc(100% + 8px)"
                                            formControlName="toDate" nzPlaceHolder="Chọn ngày" ></nz-date-picker>
                                            <div class="error-container" *ngIf="contract_type == 2">
                                                <div *ngIf="(form.get('toDate')?.invalid && (form.get('toDate')?.dirty ||form.get('toDate')?.touched))">
                                                    <span class="validate_input">{{'required.cannotBlank' | translate}}</span>
                                                </div>
                                            </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
            <div nz-col class="mx-2 date-choose">
                <div nz-row>
                    <div nz-col nzSpan="12">
                        <div style="width: calc(100% - 8px);">
                            <div class="">
                                <label class="label-form" nzRequired><span class="required-star" class="required-star">*</span> {{'employee.office' | translate}}</label>
                                <div class="w-full">
                                    <nz-select nzPlaceHolder="Chọn" formControlName="officeId" style="width: 100%;">
                                        <nz-option *ngFor="let office of listOffice, let i =index" [nzValue]="office.id"
                                            [nzLabel]="office.name"></nz-option>

                                    </nz-select>
                                    <div class="error-container">
                                        <div *ngIf="form.get('officeId')?.touched">
                                            <span class="validate_input" *ngIf="form.get('officeId')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                          
                        </div>
                    </div>
                    <div nz-col nzSpan="12">
                        <div style="width: calc(100% - 8px); margin-left: 8px" >
                           
                            <div class="">
                                <label class="label-form" nzRequired><span class="required-star">*</span> {{'employee.branch' | translate}}</label>
                                <div class="w-full">
                                    <nz-select nzPlaceHolder="Chọn" formControlName="branchId" style="width: 100%;">
                                        <nz-option *ngFor="let branch of listBranch, let i =index" [nzValue]="branch.id"
                                            [nzLabel]="branch.name"></nz-option>

                                    </nz-select>
                                    <div class="error-container">
                                        <div *ngIf="form.get('branchId')?.touched">
                                            <span class="validate_input"
                                                *ngIf="form.get('branchId')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div nz-row>
                    <div nz-col nzSpan="12">
                        <div style="width: calc(100% - 8px);">
                            
                            <div class="">
                                <label class="label-form" nzRequired><span class="required-star">*</span> {{'employee.department' | translate}}</label>
                                <div class="w-full">
                                    <nz-select nzPlaceHolder="Chọn" formControlName="departmentId" style="width: 100%;">
                                        <nz-option *ngFor="let department of listDepartment, let i =index" [nzValue]="department.id"
                                            [nzLabel]="department.name"></nz-option>

                                    </nz-select>
                                    <div class="error-container">
                                        <div *ngIf="form.get('departmentId')?.touched">
                                            <span class="validate_input"
                                                *ngIf="form.get('departmentId')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div nz-col nzSpan="12">
                       
                        <div style="width: calc(100% - 8px);  margin-left: 8px">
                            <label class="label-form"><span class="required-star">*</span> {{'employee.position' | translate}}</label>
                            <div class="w-full">
                                <nz-select nzPlaceHolder="Chọn" formControlName="positionId" style="width: 100%;">
                                    <nz-option *ngFor="let position of listPosstion, let i =index" [nzValue]="position.id"
                                        [nzLabel]="position.name"></nz-option>

                                </nz-select>
                                <div class="error-container">
                                    <div *ngIf="form.get('positionId')?.touched">
                                        <span class="validate_input"
                                            *ngIf="form.get('positionId')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div nz-col class="mx-2 labor-contract">
                <label class="label-form">{{ 'employee.laborContract' | translate}}</label>
                <div class="" style="border: 1px solid #d9d9d9; border-radius: 5px ;padding: 5px; margin-bottom: 20px;" formArrayName="contract">
                    <div  nz-row *ngFor="let contract of lstcontractDTO.controls; let i = index" [formGroupName]="i" >
                        <div class="form-col" nz-col>
                            <div class="mx-2 ">
                                <label class="label-form"><span class="required-star">*</span>{{ 'employee.dateOfSigning' | translate}}</label>
                                    <div style="width: 100%;" >
                                        <nz-date-picker nzFormat="dd/MM/yyyy" (ngModelChange)="onDateChange(['lstcontractDTO', i, 'signDate'],$event)"
                                            formControlName="signDate" class="w-full" [nzDisabledDate]="disableSignDate(i)"
                                            nzPlaceHolder="Chọn ngày"></nz-date-picker>
                                        <div class="error-container">
                                            <div *ngIf=" contract.get('signDate')?.touched">
                                            <span class="validate_input" *ngIf="contract.get('signDate')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                        </div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                        <div class="form-col" nz-col>
                            <div class="mx-2">
                                <div style="width: 100%;">
                                    <label class="label-form"><span class="required-star">*</span> {{ 'employee.laborContractFile' | translate}}</label>
                                    <div style="width: 100%;">
                                            <div nz-row class="custom-upload"
                                                style="border: 1px solid #d9d9d9; border-radius: 5px; padding: 5px; width: 100%; height: 48px !important;">
                                                <input nz-input placeholder="Chọn File" readonly class="upload-input" 
                                                    style="border: none; outline: none; flex: 1; margin-left: 2px;" formControlName="file"
                                                    [value]="fileCompressed.contractFile.length > 0 ? fileCompressed.contractFile[0].name : ''" />
                                                <button nz-button nzType="default" nzShape="circle" class="upload-button" type="button"
                                                    (click)="fileInput.click()" style="border: none; background: transparent;">
                                                    <i nz-icon nzType="paper-clip"></i>
                                                    <input type="file" #fileInput (change)="onFileChangeContract($event, 'file', i)"
                                                        style="display: none;" />
                                                </button>
                                            </div>
                                            <div class="error-container">
                                                <div *ngIf="contract.get('file')?.touched">
                                                    <span class="validate_input"
                                                        *ngIf="contract.get('file')?.errors?.['required']">{{ 'required.cannotBlank' | translate}}</span>
                                                </div>
                                            </div>
                                    </div>
                                    </div>
                            </div>
                        </div>
                        <!-- <div nz-col class="form-col" >
                            <div class="">
                                <label class="label-form" nzRequired><span class="required-star">*</span> {{'employee.duration' | translate}}</label>
                                <div class="w-full">
                                    <nz-select nzPlaceHolder="Chọn" formControlName="type" style="width: 100%;">
                                        <nz-option *ngFor="let type of listDuration, let i =index" [nzValue]="type.id"
                                            [nzLabel]="type.value"></nz-option>
    
                                    </nz-select>
                                    <div class="error-container">
                                        <div *ngIf="contract.get('type')?.touched">
                                            <span class="validate_input"
                                                *ngIf="contract.get('type')?.errors?.['required']">{{'required.duration_required' | translate}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                        <div class="form-col" nz-col>
                            <div class="mx-2 ">
                                <label class="label-form">{{ 'employee.toDate' | translate}}</label>
                                    <div style="width: 100%;" >
                                        <nz-date-picker nzFormat="dd/MM/yyyy" (ngModelChange)="onDateChange(['lstcontractDTO', i , 'toDate'],$event)"
                                            formControlName="endDate" class="w-full" [nzDisabledDate]="disableIntoEndDate(i)"
                                            nzPlaceHolder="Chọn ngày"></nz-date-picker>
                                        <!-- <div class="error-container">
                                            <div *ngIf=" contract.get('signDate')?.touched">
                                            <span class="validate_input" *ngIf="contract.get('signDate')?.errors?.['required']">{{'required.signDate' | translate}}</span>
                                        </div>
                                        </div> -->
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> 
        
        </div>
        <div class="form-container p-4 pb-0" nz-row *ngIf="hasDriver == true">

            <div class="input-wrapper ">
                <div class="">
                    <label class="label-form" ><span class="required-star">*</span> {{'employee.route' | translate}}</label>
                    <nz-select nzPlaceHolder="Chọn" formControlName="routeId" style="width: 100%;">
                        <nz-option *ngFor="let route of listRoute, let i =index" [nzValue]="route.id"
                            [nzLabel]="route.name"></nz-option>

                    </nz-select>
                    <div class="error-container">
                        <div *ngIf="form.get('routeId')?.touched">
                            <span class="validate_input"
                                *ngIf="form.get('routeId')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" for="" >{{'employee.businessCardNumber' | translate}}</label>
                    <input class="input-form" (input)="validateNumber('businessCardNumber',$event)"  placeholder="03256659"  formControlName="businessCardNumber" type="text" >
                    <div class="error-container">
                        <div *ngIf="form.get('businessCardNumber')?.invalid && (form.get('businessCardNumber')?.dirty || form.get('businessCardNumber')?.touched)">
                            <span class="validate_input" *ngIf="form.get('businessCardNumber')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            <span class="instruct" *ngIf="form.get('businessCardNumber')?.errors?.['pattern']">{{'required.number_pattern' | translate}}</span>
                        </div>
                    </div>
                </div>

            </div>

            <div  class="input-wrapper">
                <div class="">
                    <label class="label-form" ><span class="required-star">*</span> {{'employee.day_start' | translate}}</label>
                    <nz-date-picker nzFormat="dd/MM/yyyy" class="w-full" (ngModelChange)="onDateChange('bcStartDate',$event)" style="width: 100%"
                        [nzDisabledDate]="disableAfterDateDriver('bcEndDate')"
                            formControlName="bcStartDate" nzPlaceHolder="{{'Chọn ngày' | translate}}"></nz-date-picker>
                        <div class="error-container">
                            <div *ngIf="form.get('bcStartDate')?.touched">
                                <span class="validate_input" *ngIf="form.get('bcStartDate')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div  class="input-wrapper">
                <div class="">
                    <label class="label-form" > <span class="required-star">*</span>{{'employee.day_end' | translate}}</label>
                    <nz-date-picker nzFormat="dd/MM/yyyy" class="w-full" (ngModelChange)="onDateChange('bcEndDate',$event)" style="width: 100%"
                            [nzDisabledDate]="disableBeforeDate('bcStartDate')"
                            formControlName="bcEndDate" nzPlaceHolder="{{'Chọn ngày' | translate}}"></nz-date-picker>
                        <div class="error-container">
                            <div *ngIf="form.get('bcEndDate')?.touched">
                                <span class="validate_input" *ngIf="form.get('bcEndDate')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" >{{'employee.picture_card' | translate}}</label>
                    <div nz-row nzGutter="8" class="custom-upload"
                            style="border: 1px solid #d9d9d9; border-radius: 5px; padding: 5px; height: 48px !important;">
                            <input nz-input placeholder="Chọn ảnh" readonly class="upload-input" 
                                style="border: none; outline: none; flex: 1;" formControlName="bcImage" 
                                [value]="bcImageName" />
                            <button nz-button nzType="default" nzShape="circle" class="upload-button" type="button"
                                (click)="filebc.click()" style="border: none; background: transparent;">
                                <i nz-icon nzType="paper-clip" matTooltipClass="custom-tooltip" matTooltip="jpeg, jpg, png, svg, heic, webp" matTooltipPosition="above"></i>
                                <input type="file" #filebc (change)="onChangeImage($event, 'bcImage')"
                                    style="display: none;" accept=".png, .jpeg, .svg, .jpg, .heic, .webp" />
                            </button>
                        </div>
                        <div class="error-container">
                            <div *ngIf="form.get('bcImage')?.touched">
                                <span class="validate_input" *ngIf="form.get('bcImage')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div  class="input-wrapper">
                <div class="">
                    <label class="label-form" ><span class="required-star">*</span>{{'employee.healthCertificate' | translate}} </label>
                    <div nz-row nzGutter="8" class="custom-upload"
                            style="border: 1px solid #d9d9d9; border-radius: 5px; padding: 5px;  height: 48px !important;">
                            <input nz-input placeholder="Chọn file" readonly class="upload-input" 
                                style="border: none; outline: none; flex: 1; width: 100%" formControlName="healthCertificate"
                                [value]="fileCompressed.healthCertificate.length > 0 ? fileCompressed.healthCertificate[0].name : ''" />

                            <button nz-button nzType="default" nzShape="circle" class="upload-button" type="button"
                                (click)="fileInput.click()" style="border: none; background: transparent;">
                                <i nz-icon nzType="paper-clip"></i>
                                <input type="file" #fileInput (change)="onChangeHealthCertificate($event)"
                                    style="display: none;" />
                            </button>
                        </div>
                        <div class="error-container">
                            <div *ngIf="form.get('healthCertificate')?.touched">
                                <span class="validate_input"
                                    *ngIf="form.get('healthCertificate')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div  class="input-wrapper">
                <div class="">
                    <label class="label-form" ><span class="required-star">*</span> {{'employee.dayend_healthCertificate' | translate}} </label>
                    <nz-date-picker nzFormat="dd/MM/yyyy" class="w-full" (ngModelChange)="onDateChange('hcEndDate',$event)" style="width: 100%;"
                            formControlName="hcEndDate" nzPlaceHolder="{{'Chọn ngày' | translate}}"></nz-date-picker>
                        <div class="error-container">
                            <div *ngIf="form.get('hcEndDate')?.touched">
                                <span class="validate_input" *ngIf="form.get('hcEndDate')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="">
                    <label class="label-form" ><span class="required-star">*</span>{{'employee.number_healthCertificate' | translate}}</label>
                    <input nz-input class="form-input" formControlName="driverLicenseNumber" placeholder="Nhập" (input)="validateNumber('driverLicenseNumber',$event)" class="form-input" style="width: 100%;"/>
                        <div class="error-container">
                            <div *ngIf="form.get('driverLicenseNumber')?.invalid && (form.get('driverLicenseNumber')?.dirty) || form.get('driverLicenseNumber')?.touched">
                                <span class="validate_input" *ngIf="form.get('driverLicenseNumber')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                <span class="instruct" *ngIf="form.get('driverLicenseNumber')?.errors?.['pattern']">{{'required.number_pattern' | translate}}</span>

                            </div>
                       </div>
                </div>
            </div>

            <div  class="input-wrapper">
                <div class="">
                    <label class="label-form"  style="padding-left: none;"><span class="required-star">*</span> {{'employee.driverLicense' | translate}}</label>
                    <nz-select nzPlaceHolder="Chọn" formControlName="driverLicenseType" style="width: 100%;">
                        <nz-option *ngFor="let driverL of driverLicense, let i = index"[nzValue]="driverL.id" [nzLabel]="driverL.value"></nz-option>
                        
                    </nz-select>
                    <div class="error-container">
                        <div
                            *ngIf=" form.get('driverLicenseType')?.invalid && (form.get('driverLicenseType')?.dirty) ||form.get('driverLicenseType')?.touched">
                            <span class="validate_input"
                                *ngIf="form.get('driverLicenseType')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                        </div>
                    </div>
                </div>
                
            </div>

            <div class="input-wrapper">
                <div class="">
                    <label class="label-form" ><span class="required-star">*</span> {{'employee.day_start' | translate}} </label>
                    <nz-date-picker nzFormat="dd/MM/yyyy" class="w-full" (ngModelChange)="onDateChange('dlStartDate',$event)"
                        [nzDisabledDate]="disableAfterDateDriver('dlEndDate')" style="width: 100%"

                            formControlName="dlStartDate" nzPlaceHolder="{{'Chọn ngày' | translate}}"></nz-date-picker>
                        <div class="error-container">
                            <div *ngIf="form.get('dlStartDate')?.invalid && (form.get('dlStartDate')?.dirty) || form.get('dlStartDate')?.touched">
                                <span class="validate_input" *ngIf="form.get('dlStartDate')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div  class="input-wrapper">
                <div class="">
                    <label class="label-form" ><span class="required-star">*</span>{{'employee.day_end' | translate}}  </label>
                    <nz-date-picker nzFormat="dd/MM/yyyy" class="w-full" (ngModelChange)="onDateChange('dlEndDate',$event)"
                        [nzDisabledDate]="disableBeforeDate('dlStartDate')" style="width: 100%"
                            formControlName="dlEndDate" nzPlaceHolder="{{'Chọn ngày' | translate}}"></nz-date-picker>
                        <div class="error-container">
                            <div *ngIf="form.get('dlEndDate')?.invalid && (form.get('dlEndDate')?.dirty) || form.get('dlEndDate')?.touched">
                                <span class="validate_input" *ngIf="form.get('dlEndDate')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                            </div>
                        </div>
                </div>
            </div>

            <div  class="input-wrapper">
                <div class="">
                    <span class="required-star" >*</span><label class="label-form" >{{'employee.picture_driverLicens' | translate}}</label>
                    <div nz-row nzGutter="8" class="custom-upload"
                            style="border: 1px solid #d9d9d9; border-radius: 5px; padding: 5px;  height: 48px !important;">
                            <input nz-input placeholder="Chọn ảnh" readonly class="upload-input" style="width: 100%"
                                style="border: none; outline: none; flex: 1;" formControlName="dlImage"
                                [value]="dlImageName" />
                            <button nz-button nzType="default" nzShape="circle" class="upload-button" type="button"
                                (click)="fileImg.click()" style="border: none; background: transparent;">
                                <i nz-icon nzType="paper-clip" matTooltipClass="custom-tooltip"  matTooltip="jpeg, jpg, png, svg, heic, webp" matTooltipPosition="above"></i>
                                <input type="file" #fileImg (change)="onChangeImage($event, 'dlImage')" accept=".png, .jpeg, .svg, .jpg, .heic, .webp"
                                    style="display: none;" />
                            </button>
                        </div>
                        <div *ngIf="form.get('dlImage')?.invalid && (form.get('dlImage')?.dirty) || form.get('dlImage')?.touched">
                            <span class="validate_input" *ngIf="form.get('dlImage')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                        </div>
                </div>
            </div>

        </div>

        <div style="border-bottom: 1px solid #dddddd;margin-left: 30px; margin-bottom: 18px; margin-top: 18px; margin-right: 20px"></div>
        <div nz-row class="mx-4 form-container">
            <div nz-col class="recordStorage" style="margin-left:8px;  margin-right: 4px;" >
                <label class="label-form label_form" >{{'employee.archivedRecords' | translate}} </label>
                    <div nz-row formArrayName="lstArchivedRecords" class="lstArchivedRecords"
                    style="border: 1px solid #d9d9d9; border-radius: 5px ;padding: 5px; margin-bottom: 20px; width: calc(100% - 12px);">
                    <div nz-row style="display: flex; flex-wrap: nowrap; width: 100%"
                        *ngFor="let doc of lstArchivedRecords.controls; let docIndex = index"
                        [formGroupName]="docIndex">
                        <div nz-col style="width: calc(25%)">
                            <div class="mx-2">
                                <div class="">
                                    <label class="label-form">{{'employee.name_file' | translate}}</label>
                                    <input nz-input class="form-input" formControlName="name" placeholder="Nhập" style="width: 100%; margin-left: 4px"/>
                                    <div class="error-container">
                                         <div *ngIf="(doc.get('name')?.invalid && doc.get('name')?.dirty || doc.get('name')?.touched) && lstArchivedRecords.length >= 2">
                                             <span class="validate_input" *ngIf="doc.get('name')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                         </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-col style="width: calc(20%)">
                            <div class="mx-2">
                                <div class="">
                                    <label class="label-form">{{'employee.number1' | translate}}</label>
                                    <div>
                                        <input nz-input class="form-input" formControlName="code" placeholder="Nhập" />
                                        <div class="error-container">
                                            <div *ngIf="(doc.get('code')?.invalid && doc.get('code')?.dirty || doc.get('code')?.touched) && lstArchivedRecords.length >= 2">
                                                <span class="validate_input" *ngIf="doc.get('code')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-col style="width: calc(25%)">
                            <div class="mx-2">
                                <div class="">
                                    <label class="label-form">{{'employee.type_file' | translate}}</label>
                                    <div>
                                        <input nz-input class="form-input"  formControlName="type" placeholder="Nhập" />
                                        <div class="error-container">
                                            <div *ngIf="(doc.get('type')?.invalid && (doc.get('type')?.dirty) || doc.get('type')?.touched) && lstArchivedRecords.length >= 2">
                                                <span class="validate_input" *ngIf="doc.get('type')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-col style="width: calc(20%)">
                            <div class="mx-2">
                                <div class="">
                                    <label class="label-form">{{'employee.file_together' | translate}}</label>
                                    <div>

                                        <div nz-row nzGutter="8" class="custom-upload"
                                            style="border: 1px solid #d9d9d9; border-radius: 5px; padding: 5px; height: 48px !important;">
                                            <input nz-input placeholder="Chọn file" readonly class="upload-input"
                                                style="border: none; outline: none; flex: 1;" formControlName="file"
                                                [value]="fileCompressed.file[docIndex] ? fileCompressed.file[docIndex].name : ''" />
                                            <button nz-button nzType="default" nzShape="circle" class="upload-button"
                                                (click)="fileInput.click()" type="button"
                                                style="border: none; background: transparent;">
                                                <i nz-icon nzType="paper-clip"></i>
                                                <input type="file" #fileInput (change)="onFileChangeAchi($event,'file', docIndex)" style="display: none;" />
                                            </button>
                                        </div>
                                        <div class="error-container">
                                            <div *ngIf="(doc.get('file')?.invalid && doc.get('file')?.dirty || doc.get('file')?.touched)  && lstArchivedRecords.length >= 2">
                                                <span class="validate_input"
                                                    *ngIf="doc.get('file')?.errors?.['required']">{{'required.cannotBlank' | translate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-col style="width: calc(10%); display: flex; justify-content: center; align-items: center;">
                            <button type="button" nz-button (click)="removeArchivedRecord(docIndex)" [hidden]="lstArchivedRecords.length == 1" *ngIf="lstArchivedRecords.length > 1 || ( lstArchivedRecords.at(0).invalid )" style=" border: none;" >
                                <svg width="16" height="19" viewBox="0 0 16 19" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M3 18.5C2.45 18.5 1.97917 18.3042 1.5875 17.9125C1.19583 17.5208 1 17.05 1 16.5V3.5H0V1.5H5V0.5H11V1.5H16V3.5H15V16.5C15 17.05 14.8042 17.5208 14.4125 17.9125C14.0208 18.3042 13.55 18.5 13 18.5H3ZM5 14.5H7V5.5H5V14.5ZM9 14.5H11V5.5H9V14.5Z"
                                        fill="#EF4444" />
                                </svg>

                            </button>
                            <button type="button" (click)="cleanAchive()" *ngIf="lstArchivedRecords.length == 1 && isAnyFieldFilled()" matTooltip="Làm mới" matTooltipPosition="above">
                                <svg width="25px" height="25px" style="fill: #274EA1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M5.50506 11.4096L6.03539 11.9399L5.50506 11.4096ZM3 14.9522H2.25H3ZM9.04776 21V21.75V21ZM11.4096 5.50506L10.8792 4.97473L11.4096 5.50506ZM13.241 17.8444C13.5339 18.1373 14.0088 18.1373 14.3017 17.8444C14.5946 17.5515 14.5946 17.0766 14.3017 16.7837L13.241 17.8444ZM7.21629 9.69832C6.9234 9.40543 6.44852 9.40543 6.15563 9.69832C5.86274 9.99122 5.86274 10.4661 6.15563 10.759L7.21629 9.69832ZM17.9646 12.0601L12.0601 17.9646L13.1208 19.0253L19.0253 13.1208L17.9646 12.0601ZM6.03539 11.9399L11.9399 6.03539L10.8792 4.97473L4.97473 10.8792L6.03539 11.9399ZM6.03539 17.9646C5.18538 17.1146 4.60235 16.5293 4.22253 16.0315C3.85592 15.551 3.75 15.2411 3.75 14.9522H2.25C2.25 15.701 2.56159 16.3274 3.03 16.9414C3.48521 17.538 4.1547 18.2052 4.97473 19.0253L6.03539 17.9646ZM4.97473 10.8792C4.1547 11.6993 3.48521 12.3665 3.03 12.9631C2.56159 13.577 2.25 14.2035 2.25 14.9522H3.75C3.75 14.6633 3.85592 14.3535 4.22253 13.873C4.60235 13.3752 5.18538 12.7899 6.03539 11.9399L4.97473 10.8792ZM12.0601 17.9646C11.2101 18.8146 10.6248 19.3977 10.127 19.7775C9.64651 20.1441 9.33665 20.25 9.04776 20.25V21.75C9.79649 21.75 10.423 21.4384 11.0369 20.97C11.6335 20.5148 12.3008 19.8453 13.1208 19.0253L12.0601 17.9646ZM4.97473 19.0253C5.79476 19.8453 6.46201 20.5148 7.05863 20.97C7.67256 21.4384 8.29902 21.75 9.04776 21.75V20.25C8.75886 20.25 8.449 20.1441 7.9685 19.7775C7.47069 19.3977 6.88541 18.8146 6.03539 17.9646L4.97473 19.0253ZM17.9646 6.03539C18.8146 6.88541 19.3977 7.47069 19.7775 7.9685C20.1441 8.449 20.25 8.75886 20.25 9.04776H21.75C21.75 8.29902 21.4384 7.67256 20.97 7.05863C20.5148 6.46201 19.8453 5.79476 19.0253 4.97473L17.9646 6.03539ZM19.0253 13.1208C19.8453 12.3008 20.5148 11.6335 20.97 11.0369C21.4384 10.423 21.75 9.79649 21.75 9.04776H20.25C20.25 9.33665 20.1441 9.64651 19.7775 10.127C19.3977 10.6248 18.8146 11.2101 17.9646 12.0601L19.0253 13.1208ZM19.0253 4.97473C18.2052 4.1547 17.538 3.48521 16.9414 3.03C16.3274 2.56159 15.701 2.25 14.9522 2.25V3.75C15.2411 3.75 15.551 3.85592 16.0315 4.22253C16.5293 4.60235 17.1146 5.18538 17.9646 6.03539L19.0253 4.97473ZM11.9399 6.03539C12.7899 5.18538 13.3752 4.60235 13.873 4.22253C14.3535 3.85592 14.6633 3.75 14.9522 3.75V2.25C14.2035 2.25 13.577 2.56159 12.9631 3.03C12.3665 3.48521 11.6993 4.1547 10.8792 4.97473L11.9399 6.03539ZM14.3017 16.7837L7.21629 9.69832L6.15563 10.759L13.241 17.8444L14.3017 16.7837Z" fill="#1C274C"/>
                                    <path d="M9 21H21" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>

                            </button>
                        </div>
                    </div>
                    <div nz-row class="w-full" style="margin-bottom: 31px;">
                        <div nz-row>
                            <button (click)="addArchivedRecords()" type="button" class="button_add mx-2"><svg
                                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor" class="size-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                </svg>
                            </button>
                        </div>
                    </div>

                
                </div>


            </div>
            <div nz-col class="children" >
                <label class="label-form label_form">{{'employee.children_status' | translate}}</label>
                <div nz-row style="border: 1px solid #d9d9d9; border-radius: 5px ;padding: 5px; margin-bottom: 20px;">
                    <div nz-row class="w-full mx-2" style="height: 32px !important; line-height: 32px;">
                        <div class="">
                            <nz-radio-group formControlName="hasChild">
                                <label nz-radio nzValue="0">Chưa có con</label>
                                <label nz-radio nzValue="1">Đã có con</label>
                            </nz-radio-group>
                        </div>
                    </div>
                    <div class="w-full" formArrayName="lstChildren"  [class.disabled-input]="has_child == '0' || form.get('hasChild')?.value == '0' " >
                        <div nz-row style="display: flex; flex-wrap: nowrap;" *ngFor="let child of lstChildren.controls; let childIndex = index" [formGroupName]="childIndex">
                            <div nz-col nzSpan="10">
                                <div class="mx-2">
                                    <div class="">
                                        <label class="label-form"><span class="required-star">*</span>{{'employee.name_child' | translate}}</label>
                                        <div>
                                            <input nz-input class="form-input" (input)="validateText(['lstChildren', childIndex, 'name'],$event)"  (blur)="onBlur(['lstChildren', childIndex, 'name'])"  formControlName="name" placeholder="Nhập"  style="width: 100%"  />
                                                <div class="error-container">
                                                    <div *ngIf="has_child == 1 && ((child.get('name')?.invalid && child.get('name')?.dirty ) || child.get('name')?.touched)">
                                                        <span class="validate_input" *ngIf="child.get('name')?.errors?.['required']" >{{'required.cannotBlank' | translate}}</span>
                                                        <span class="instruct" *ngIf="child.get('name')?.errors?.['pattern']">{{'required.text_pattern' | translate}}</span>
                                                        
                                                    </div>
                                                </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div nz-col nzSpan="6">
                                <div class="mx-2">
                                    <div class="">
                                        <label class="label-form"><span class="required-star">*</span>{{'employee.yearOfBirth' | translate}}</label>
                                        <div>
                                            <input nz-input class="form-input" type="text" (input)="validateYearOfBirthChild(['child','yearOfBirth'],$event)" maxlength="4" formControlName="yearOfBirth" placeholder="Nhập năm" style="width: 100%"/>
                                                <div class="error-container">
                                                    <div *ngIf="(child.get('yearOfBirth')?.invalid && child.get('yearOfBirth')?.dirty || child.get('yearOfBirth')?.touched) && has_child == 1">
                                                        <span class="validate_input" *ngIf="child.get('yearOfBirth')?.errors?.['required']" >{{'required.cannotBlank' | translate}}</span>
                                                        <span class="instruct" *ngIf="child.get('yearOfBirth')?.errors?.['pattern']" >{{'required.number_pattern' | translate}}</span>
                                                        <span class="instruct" *ngIf="child.get('yearOfBirth')?.errors?.['min'] && !child.get('yearOfBirth')?.errors?.['pattern']"> {{('required.minYearEmployee' | translate) + minYearChild}}</span>
                                                        <span class="instruct" *ngIf="child.get('yearOfBirth')?.errors?.['max'] && !child.get('yearOfBirth')?.errors?.['pattern']"> {{('required.maxYearEmployee' | translate) + maxYearChild}}</span>
                                                    </div>
                                                </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div nz-col nzSpan="6">
                                <div class="mx-2">
                                    <div class="">
                                        <label class="label-form"><span class="required-star">*</span>{{'employee.gender' | translate}}</label>
                                        <nz-select nzPlaceHolder="Chọn" formControlName="gender"  style="width: 100%">
                                            <nz-option *ngFor="let gender of listGender" [nzValue]="gender.id" [nzLabel]="gender.value"></nz-option>
                                        </nz-select>
                                        <div class="error-container">
                                            <div *ngIf="(child.get('gender')?.invalid && child.get('gender')?.dirty || child.get('gender')?.touched )&& has_child == 1">
                                                <span class="validate_input" *ngIf="child.get('gender')?.hasError('required')">{{'required.cannotBlank' | translate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div nz-col *ngIf="lstChildren.length > 1   && has_child == '1'"
                                style="display: flex; justify-content: center; align-items: center; margin-left: 7px;">
                                <a (click)="removelstChildren(childIndex)"  style=" border: none;">
                                    <svg width="16" height="19" viewBox="0 0 16 19" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M3 18.5C2.45 18.5 1.97917 18.3042 1.5875 17.9125C1.19583 17.5208 1 17.05 1 16.5V3.5H0V1.5H5V0.5H11V1.5H16V3.5H15V16.5C15 17.05 14.8042 17.5208 14.4125 17.9125C14.0208 18.3042 13.55 18.5 13 18.5H3ZM5 14.5H7V5.5H5V14.5ZM9 14.5H11V5.5H9V14.5Z"
                                            fill="#EF4444" />
                                    </svg>

                                </a>
                            </div>

                        </div>
                    </div>
                    <div nz-row class="w-full"  [class.disabled-input]="has_child == '0' || form.get('hasChild')?.value == '0' " >
                        <div >
                            <button (click)="addlstChildren()" type="button" class="button_add mx-2"><svg
                                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke-width="1.5" stroke="currentColor" class="size-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
    </div>
    <div class="flex justify-end mx-4" style="padding-top: 8px">
        <span>
            <button  (click)="endClick()" type="button" class="button" nz-button style="color: #274EA1;" nzType="default">Reset</button>
        </span>
        <span class="ml-2">
            <button class="button" type="submit" style="background-color: #274EA1; color: white;" nz-button>Lưu</button>
        </span>
    </div>
</form>

<nz-modal [(nzVisible)]="isModalInforEmployee" (nzOnCancel)="handleCancel()" (nzOnOk)="handleSubmit()"
    [nzContent]="modalContent" [nzFooter]="null" [nzStyle]="{'max-width' : '80vw', 'max-height':'100vh'}">
    <ng-template #modalContent>
        <div class="headmodal">
            <span style="font-weight: 500; font-size: 24px;">Thông tin nhân sự</span>
        </div>
        <div nz-row>
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Tên nhân viên</td>
                                <td class="col-2">{{ inforEmployee.name || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Năm sinh</td>
                                <td class="col-2">{{ inforEmployee.yearOfBirth || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Giới tính</td>
                                <td class="col-2">
                                    <span *ngIf="inforEmployee.gender == 1">
                                        {{'employee.man'| translate}}
                                    </span>
                                    <span *ngIf="inforEmployee.gender == 2">
                                        {{'employee.woman'| translate}}
                                        
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-1">Dân tộc</td>
                                <td class="col-2">{{ inforEmployee.ethnicGroup || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Tôn giáo</td>
                                <td class="col-2">{{ inforEmployee.religion || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-3">Địa chỉ thường trú</td>
                                <td class="col-4">{{ inforEmployee.permanentAddress || '' }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Số điện thoại</td>
                                <td class="col-2">{{ inforEmployee.phoneNumber || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Zalo</td>
                                <td class="col-2">{{ inforEmployee.zalo || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Email</td>
                                <td class="col-2">{{ inforEmployee.email || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">CCCD</td>
                                <td class="col-2">{{ inforEmployee.identifierId || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Id nhân viên</td>
                                <td class="col-2" style="color: #274ea1;">{{ codeEmployee || '-' }}</td>
                            </tr>
                            <tr>
                                <td class="col-3">Địa chỉ tạm trú</td>
                                <td class="col-4">{{ inforEmployee.temporaryAddress || '' }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div style="margin-top: 36px;">
        </div>
        <div nz-row>
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Trình độ chuyên môn</td>
                                <td class="col-2">{{ inforEmployee.professionalLevel || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Tình trạng hôn nhân</td>
                                <td class="col-2">
                                    <span *ngIf="inforEmployee.maritalStatus == 0">Chưa kết hôn</span>
                                    <span *ngIf="inforEmployee.maritalStatus == 1">Đã kết hôn</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-1">Tình trạng con cái</td>
                                <td class="col-2">
                                    <span *ngIf="form.get('hasChild')?.value == 0">Chưa có con</span>
                                    <span *ngIf="form.get('hasChild')?.value == 1">Đã có con</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Người liên hệ</td>
                                <td class="col-2">{{ inforEmployee.contactPerson || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">SĐT người LH</td>
                                <td class="col-2">{{ inforEmployee.contactPersonPhone || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Quan hệ với NV</td>
                                <td class="col-2">{{ inforEmployee.staffRelation || '' }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div style="margin-top: 36px;">
        </div>
        <div nz-row>
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Trực thuộc quản lý</td>
                                <td class="col-2">{{ officeName }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Chi nhánh</td>
                                <td class="col-2">{{branchName }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Bộ phận</td>
                                <td class="col-2">{{ deparmentName }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Chức vụ</td>
                                <td class="col-2">{{ positionName}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Tình trạng làm việc</td>
                                <td class="col-2">
                                    <span *ngIf="form.get('contractType')?.value == 1">Chính thức</span>
                                    <span *ngIf="form.get('contractType')?.value == 2">Thử việc</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-1">Từ ngày</td>
                                <td class="col-2">{{ inforEmployee.fromDateOfOffical  || inforEmployee.fromDateProbation | date:'dd/MM/yyyy'}}</td>
                            </tr>
                            <tr *ngIf="hasDriver == true">
                                <td class="col-1">Định biên tuyến</td>
                                <td class="col-2">{{ routeName}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div style="margin-top: 36px;">
        </div>
        <div nz-row *ngIf="hasDriver == true">
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Số thẻ nghiệp vụ</td>
                                <td class="col-2">{{inforEmployee.businessCardNumber || '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Ngày cấp</td>
                                <td class="col-2">{{ inforEmployee.bcStartDate | date: 'dd/MM/yyy' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Ngày hết hạn</td>
                                <td class="col-2">{{ inforEmployee.bcEndDate | date:'dd/MM/yyyy' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Ngày hết hạn GKSK</td>
                                <td class="col-2">{{ inforEmployee.hcEndDate | date:'dd/MM/yyyy' }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div nz-col nzSpan="12">
                <div nz-col nzSpan="21" class="mx-4">
                    <table class="custom-table">
                        <tbody>
                            <tr>
                                <td class="col-1">Số GPLX</td>
                                <td class="col-2">{{ inforEmployee.driverLicenseNumber|| '' }}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Hạng</td>
                                <td class="col-2">{{ getNameInput(inforEmployee.driverLicenseType, 'driverLicense')}}
                                </td>
                            </tr>
                            <tr>
                                <td class="col-1">Ngày cấp</td>
                                <td class="col-2">{{inforEmployee.dlStartDate | date:'dd/MM/yyyy'}}</td>
                            </tr>
                            <tr>
                                <td class="col-1">Ngày hết hạn</td>
                                <td class="col-2">{{inforEmployee.dlEndDate | date:'dd/MM/yyyy'}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div style="margin-top: 36px;">
        </div>
        <div nz-row>
            <div nz-col nzSpan="24">
                <div nz-col style="width: calc(100% - 56px) !important;" class=" mx-4">
                    <span style="font-size: 14px; color: #6b7280;">Danh sách giấy tờ </span>
                    <table class="custom-table-list">
                        <tbody>
                            <tr style="background-color: #f4f7fb;">
                                <th style="text-align: center;" class="list-col-1">STT</th>
                                <th class="list-col-2">Tên giấy tờ</th>
                                <th style="text-align: center;" class="list-col-3">Số hiệu</th>
                                <th style="text-align: center;" class="list-col-4">Loại giấy tờ</th>
                            </tr>
                            <tr *ngFor="let data of listAR, let i = index">
                                <td style="text-align: center;" class="list-col-1">
                                    <span *ngIf="data.code">{{ i +1}}</span>
                                    <span *ngIf="!data.code">{{'-'}}</span>
                                </td>
                                <td class="list-col-2">{{data.name || '-'}}</td>
                                <td style="text-align: center;" class="list-col-3">{{data.code || '-'}}</td>
                                <td style="text-align: center;" class="list-col-4">{{data.type || '-'}}</td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div style="margin-top: 36px;">
        </div>
        <div nz-row *ngIf="hasChildren == 1">
            <div nz-col nzSpan="24">
                <div nz-col nzSpan="23" class="mx-4">
                    <span style="font-size: 14px; color: #6b7280;">Danh sách con của nhân viên</span>
                    <table class="custom-table-list">
                        <tbody>
                            <tr style="background-color: #f4f7fb;">
                                <th style="text-align: center;" class="list-col-1">STT</th>
                                <th class="list-col-2">Tên con</th>
                                <th style="text-align: center;" class="list-col-3">Năm sinh</th>
                                <th style="text-align: center;" class="list-col-4">Giới tính</th>
                            </tr>
                            <tr *ngFor="let data of listCh, let i = index">
                                <td style="text-align: center;" class="list-col-1">{{i + 1}}</td>
                                <td class="list-col-2">{{data.name || '-'}}</td>
                                <td style="text-align: center;" class="list-col-3">{{data.yearOfBirth || '-'}}</td>
                                <td style="text-align: center;" class="list-col-4">
                                    <span *ngIf="data.gender == 2">Nữ</span>
                                    <span *ngIf="data.gender == 1">Nam</span>
                                    <span *ngIf="!data.gender"></span>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div style="margin-top: 42px;">
        </div>
        <div nz-row style="display: flex; justify-content: center;">
            <div nz-rol>
                <span>
                    <button class="button-infor" nz-button style="color: #274EA1;" nzType="default" type="button"
                        (click)="handleCancel()">Quay lại</button>
                </span>
            </div>
            <div nz-rol class="ml-2">
                <span>
                    <button class="button-infor" type="button" nz-button style="color: #274EA1;" nzType="default" (click)="saveDataEmployee('print')">
                        <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M11.6667 3.33333H2.33333C1.22667 3.33333 0.333332 4.22667 0.333332 5.33333V8C0.333332 8.73333 0.933332 9.33333 1.66667 9.33333H3V10.6667C3 11.4 3.6 12 4.33333 12H9.66667C10.4 12 11 11.4 11 10.6667V9.33333H12.3333C13.0667 9.33333 13.6667 8.73333 13.6667 8V5.33333C13.6667 4.22667 12.7733 3.33333 11.6667 3.33333ZM9 10.6667H5C4.63333 10.6667 4.33333 10.3667 4.33333 10V7.33333H9.66667V10C9.66667 10.3667 9.36667 10.6667 9 10.6667ZM11.6667 6C11.3 6 11 5.7 11 5.33333C11 4.96667 11.3 4.66667 11.6667 4.66667C12.0333 4.66667 12.3333 4.96667 12.3333 5.33333C12.3333 5.7 12.0333 6 11.6667 6ZM10.3333 0H3.66667C3.3 0 3 0.3 3 0.666667V2C3 2.36667 3.3 2.66667 3.66667 2.66667H10.3333C10.7 2.66667 11 2.36667 11 2V0.666667C11 0.3 10.7 0 10.3333 0Z"
                                fill="#274EA1" />
                        </svg>
                        <span>In</span>
                    </button>
                </span>
            </div>
            <div nz-rol class="ml-2">
                <button class="button-infor" type="button" style="background-color: #274EA1; color: white;" nz-button nzType="default"
                    (click)="saveDataEmployee('saveData')">Xác nhận</button>
            </div>
        </div>
    </ng-template>
</nz-modal>


<nz-modal [(nzVisible)]="isDone" (nzOnCancel)="handleCancelDone1()" (nzOnOk)="handleSubmitDone()"
    [nzContent]="modalContentDone" [nzFooter]="null" [nzStyle]="{'min-width' : '560px', 'min-height':'760px'}">
    <ng-template #modalContentDone>
        <div class="headmodal">
            <span style="color: green; justify-content: center; align-items: center; font-size: 55px" nz-icon nzType="check-circle" nzTheme="outline"></span>
        </div>
        <div >
            <div style="text-align: center;"><span style="color: green; font-size: 25px; ">Thêm thành công!</span><br><span style="font-size: 20px;">Bạn có muốn tiếp tục thêm nhân sự không? </span></div>
            
            <div style="display: flex; gap: 8px; justify-content: center; margin-top: 20px"> 
                <span>
                    <button class="button-infor" nz-button style="color: #274EA1;" nzType="default" type="button"
                        (click)="endClick()">Thêm mới</button>
                </span>
                <span>
                    <button class="button-infor" nz-button style="color: #ffffff; background-color: #274EA1;" nzType="default" type="button"
                        (click)="handleSubmitDone()">Đến danh sách</button>
                </span>
            </div>
        </div>
        
    </ng-template>
</nz-modal>

